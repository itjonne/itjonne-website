(this.webpackJsonpwebsite=this.webpackJsonpwebsite||[]).push([[0],{110:function(e,t,a){},228:function(e,t,a){"use strict";a.r(t);var n={};a.r(n),a.d(n,"HOME",(function(){return l})),a.d(n,"SIGN_IN",(function(){return d}));var s=a(5),r=a(0),c=a(94),o=a.n(c),i=(a(110),a(29)),u=a(8),l="/",d="/signin",j=a(95),b=a(26),h=(a(111),a(114),{apiKey:"AIzaSyDTXVBIqR12248JX1ImrICuERIdGVMMVMk",authDomain:"draw-621d4.firebaseapp.com",databaseURL:"https://draw-621d4-default-rtdb.europe-west1.firebasedatabase.app",projectId:"draw-621d4",storageBucket:"draw-621d4.appspot.com",messagingSenderId:"1002291615269",appId:"1:1002291615269:web:6362a79fb605e29e7e91cc",measurementId:"G-MDDBY9PTL6"});console.log(h);var O=function e(){var t=this;Object(j.a)(this,e),this.database=void 0,this.auth=void 0,this.user=void 0,this.admin="4jJw2Qp9zchYpmsNmqiw2dOwWZ13",this.setLoggedUser=function(e){t.user=e},this.getLoggedUser=function(){return t.user},this.createUserWithEmailAndPassword=function(e,a){return t.auth.createUserWithEmailAndPassword(e,a)},this.signInWithEmailAndPassword=function(e,a){return t.auth.signInWithEmailAndPassword(e,a)},this.signOut=function(){return t.auth.signOut},this.passwordReset=function(e){return t.auth.sendPasswordResetEmail(e)},this.passwordUpdate=function(e){if(t.auth.currentUser)return t.auth.currentUser.updatePassword(e)},this.checkIfLoggedIn=function(){return t.auth.currentUser},this.getUsers=function(){return t.database.ref("/users")},this.getImages=function(){return t.database.ref("users/"+t.admin+"/images")},this.addImage=function(e){if(t.auth.currentUser){var a=b.a.database().ref("users/"+t.auth.currentUser.uid+"/images").push().key;console.log(a);var n="/users/".concat(t.auth.currentUser.uid,"/images/").concat(a);try{console.log("trying to push",e),b.a.database().ref(n).set(e)}catch(s){console.log(s)}}else console.log("Not logged in")},b.a.initializeApp(h),this.database=b.a.database(),this.auth=b.a.auth(),this.user=null},g=Object(r.createContext)(null),m=O,f=function(){var e=Object(r.useContext)(g);return console.log("rendering navigation"),Object(s.jsxs)("div",{className:"header",children:[Object(s.jsx)(i.b,{className:"header-link",to:n.HOME,children:"://itjonne"}),e&&e.getLoggedUser()&&Object(s.jsx)("button",{onClick:function(t){null===e||void 0===e||e.signOut()},children:"Kirjaudu ulos"})]})},p=a(41),v=a(15),x=a(12),w={email:"",password:"",error:""},S=function(){var e=Object(r.useState)(w),t=Object(x.a)(e,2),a=t[0],c=t[1],o=Object(r.useContext)(g),i=Object(u.e)(),l=a.email,d=a.password,j=a.error,b=function(e){c(Object(v.a)(Object(v.a)({},a),{},Object(p.a)({},e.target.name,e.target.value)))};return Object(s.jsxs)("div",{className:"signin",children:[Object(s.jsx)("h1",{children:"Kirjaudu Sis\xe4\xe4n:"}),Object(s.jsxs)("form",{onSubmit:function(e){e.preventDefault(),o&&o.signInWithEmailAndPassword(l,d).then((function(e){o.setLoggedUser(e),c(Object(v.a)({},w)),console.log("Signed in as:",e),i.push(n.HOME)})).catch((function(e){console.log(e),c(Object(v.a)(Object(v.a)({},a),{},{error:e.message}))}))},children:[Object(s.jsx)("input",{onChange:b,name:"email",value:l,type:"email",placeholder:"S\xe4hk\xf6posti (admin@admin.com)"}),Object(s.jsx)("input",{onChange:b,name:"password",value:d,type:"password",placeholder:"salasana (admin)"}),j&&Object(s.jsx)("p",{className:"error",children:j}),Object(s.jsx)("button",{type:"submit",children:"Kirjaudu Sis\xe4\xe4n"})]})]})},I=a(30),N=a(104),C=function(e){var t=Object(r.useState)("#000000"),a=Object(x.a)(t,2),n=a[0],c=a[1],o=Object(r.useState)("#000000"),i=Object(x.a)(o,2),u=i[0],l=i[1],d=Object(r.useState)(null),j=Object(x.a)(d,2),b=(j[0],j[1]),h=Object(r.useState)(1),O=Object(x.a)(h,2),m=(O[0],O[1],Object(r.useState)(!1)),f=Object(x.a)(m,2),p=(f[0],f[1],Object(r.useRef)(null)),w=Object(r.useContext)(g);return Object(s.jsxs)("div",{className:"drawingComponent",children:[Object(s.jsx)("div",{className:"drawableCanvas",children:Object(s.jsx)(I.a,Object(v.a)({ref:p,brushColor:u,catenaryColor:u},e))}),Object(s.jsxs)("div",{className:"toolbar",children:[Object(s.jsx)("div",{className:"tool",children:Object(s.jsx)("button",{onClick:function(){return p.current.undo()},children:"Kumoa"})}),Object(s.jsx)("div",{className:"tool",children:Object(s.jsx)(N.a,{color:n,onChange:function(e){var t,a=100*parseFloat(e.rgb.a),n=(t=a,Math.max(0,Math.min(100,t)),Math.round(t/100*255).toString(16).padStart(2,"0").toUpperCase());console.log(a),console.log(n),c(e.rgb),l(e.hex+n)}})}),Object(s.jsx)("div",{className:"tool",children:Object(s.jsx)("button",{onClick:function(){return console.log(p.current.getSaveData()),localStorage.setItem("savedDrawing",p.current.getSaveData()),w.addImage(localStorage.getItem("savedDrawing")),p.current.clear(),void b(!0)},children:"Tallenna kuva!"})})]})]})},U=function(e){var t=Object(r.useRef)(null);Object(r.useEffect)((function(){console.log("useeffect Canvas"),t.current.loadSaveData(e.data)}),[]);var a,n;return console.log("rendering"),Object(s.jsx)("div",{className:"canvas",onClick:function(a){return t.current.clear(),void t.current.loadSaveData(e.data)},children:Object(s.jsx)(I.a,Object(v.a)(Object(v.a)({ref:t},e),{},{loadTimeOffset:(a=10,n=50,Math.floor(Math.random()*(n-a+1))+a)}))})},k=function(){var e=Object(r.useState)([]),t=Object(x.a)(e,2),a=t[0],n=t[1],c=Object(r.useState)(!0),o=Object(x.a)(c,2),i=o[0],u=o[1],l=Object(r.useState)([]),d=Object(x.a)(l,2),j=(d[0],d[1],Object(r.useContext)(g));Object(r.useEffect)((function(){console.log("Getting images"),j.getImages().on("value",(function(e){for(var t=e.val(),a=[],s=0,r=Object.keys(t);s<r.length;s++){var c=r[s];a.push(t[c])}n(a),u(!1)}))}),[]);Object(r.useRef)(null);return console.log(a),Object(s.jsxs)("div",{className:"gallery",children:[i&&Object(s.jsx)("div",{className:"loading",children:Object(s.jsx)("p",{children:"Gallery loading..."})}),a&&a.map((function(e,t){return Object(s.jsx)(U,{data:e,canvasHeight:200,canvasWidth:200,disabled:!0},t)}))]})},y=function(){return Object(s.jsxs)("div",{className:"home",children:[Object(s.jsx)("h1",{className:"center",children:"Tervetuloa!"}),Object(s.jsx)(k,{}),Object(s.jsx)(C,{lazyRadius:0,hideGrid:!0,brushRadius:5})]})},E=function(){return Object(s.jsxs)(i.a,{children:[Object(s.jsx)(f,{}),Object(s.jsx)(u.a,{exact:!0,path:n.HOME,component:y}),Object(s.jsx)(u.a,{path:n.SIGN_IN,component:S})]})};o.a.render(Object(s.jsx)(g.Provider,{value:new m,children:Object(s.jsx)(E,{})}),document.getElementById("root"))}},[[228,1,2]]]);
//# sourceMappingURL=main.0d88a5a9.chunk.js.map