(this.webpackJsonpwebsite=this.webpackJsonpwebsite||[]).push([[0],{110:function(e,t,a){},228:function(e,t,a){"use strict";a.r(t);var n={};a.r(n),a.d(n,"HOME",(function(){return d})),a.d(n,"SIGN_IN",(function(){return l}));var s=a(4),r=a(0),c=a(94),i=a.n(c),u=(a(110),a(27)),o=a(8),d="/",l="/signin",j=a(95),b=a(19),h=(a(111),a(114),{apiKey:"AIzaSyDTXVBIqR12248JX1ImrICuERIdGVMMVMk",authDomain:"draw-621d4.firebaseapp.com",databaseURL:"https://draw-621d4-default-rtdb.europe-west1.firebasedatabase.app",projectId:"draw-621d4",storageBucket:"draw-621d4.appspot.com",messagingSenderId:"1002291615269",appId:"1:1002291615269:web:6362a79fb605e29e7e91cc",measurementId:"G-MDDBY9PTL6"});console.log(h);var O=function e(){var t=this;Object(j.a)(this,e),this.database=void 0,this.auth=void 0,this.user=void 0,this.admin="4jJw2Qp9zchYpmsNmqiw2dOwWZ13",this.setLoggedUser=function(e){t.user=e},this.getLoggedUser=function(){return t.auth.currentUser},this.createUserWithEmailAndPassword=function(e,a){return t.auth.createUserWithEmailAndPassword(e,a)},this.signInWithEmailAndPassword=function(e,a){return t.auth.signInWithEmailAndPassword(e,a)},this.signOut=function(){return t.auth.signOut()},this.passwordReset=function(e){return t.auth.sendPasswordResetEmail(e)},this.passwordUpdate=function(e){if(t.auth.currentUser)return t.auth.currentUser.updatePassword(e)},this.checkIfLoggedIn=function(){return t.auth.currentUser},this.getUsers=function(){return t.database.ref("/users")},this.getImages=function(){return t.database.ref("users/"+t.admin+"/images")},this.addImage=function(e){if(t.auth.currentUser){var a=b.a.database().ref("users/"+t.auth.currentUser.uid+"/images").push().key,n="/users/".concat(t.auth.currentUser.uid,"/images/").concat(a);try{b.a.database().ref(n).set(e)}catch(r){console.log(r)}}else{console.log("Not logged in");a=b.a.database().ref("users/"+t.admin+"/images").push().key;var s="/users/".concat(t.admin,"/images/").concat(a);try{b.a.database().ref(s).set(e)}catch(r){console.log(r)}}},b.a.initializeApp(h),this.database=b.a.database(),this.auth=b.a.auth(),this.user=null},m=Object(r.createContext)(null),f=O,g=function(){var e=Object(r.useContext)(m),t=Object(o.f)();return Object(s.jsxs)("div",{className:"header",children:[Object(s.jsx)(u.b,{className:"header-link",to:n.HOME,children:"://itjonne"}),Object(s.jsx)("button",{onClick:function(a){null===e||void 0===e||e.signOut(),t.push(n.SIGN_IN)},children:"Kirjaudu ulos"})]})},p=a(41),v=a(14),x=a(18),w={email:"",password:"",error:""},I=function(){var e=Object(r.useState)(w),t=Object(x.a)(e,2),a=t[0],c=t[1],i=Object(r.useContext)(m),u=Object(o.f)(),d=a.email,l=a.password,j=a.error,b=function(e){c(Object(v.a)(Object(v.a)({},a),{},Object(p.a)({},e.target.name,e.target.value)))};return Object(s.jsxs)("div",{className:"signin",children:[Object(s.jsx)("h1",{children:"Kirjaudu Sis\xe4\xe4n:"}),Object(s.jsxs)("form",{onSubmit:function(e){e.preventDefault(),i&&i.signInWithEmailAndPassword(d,l).then((function(e){i.setLoggedUser(e),c(Object(v.a)({},w)),u.push(n.HOME)})).catch((function(e){console.log(e),c(Object(v.a)(Object(v.a)({},a),{},{error:e.message}))}))},children:[Object(s.jsx)("input",{onChange:b,name:"email",value:d,type:"email",placeholder:"S\xe4hk\xf6posti (admin@admin.com)"}),Object(s.jsx)("input",{onChange:b,name:"password",value:l,type:"password",placeholder:"salasana (admin)"}),j&&Object(s.jsx)("p",{className:"error",children:j}),Object(s.jsx)("button",{type:"submit",children:"Kirjaudu Sis\xe4\xe4n"})]})]})},N=a(30),S=a(104),k=function(e){var t=Object(r.useState)("#000000"),a=Object(x.a)(t,2),n=a[0],c=a[1],i=Object(r.useState)("#000000"),u=Object(x.a)(i,2),o=u[0],d=u[1],l=Object(r.useRef)(null),j=Object(r.useContext)(m);return Object(s.jsxs)("div",{className:"drawingComponent",children:[Object(s.jsx)("div",{className:"drawableCanvas",children:Object(s.jsx)(N.a,Object(v.a)({ref:l,brushColor:o,catenaryColor:o},e))}),Object(s.jsxs)("div",{className:"toolbar",children:[Object(s.jsx)("div",{className:"tool",children:Object(s.jsx)("button",{onClick:function(){return l.current.undo()},children:"Kumoa"})}),Object(s.jsx)("div",{className:"tool center",children:Object(s.jsx)(S.a,{color:n,onChange:function(e){var t,a=100*parseFloat(e.rgb.a),n=(t=a,Math.max(0,Math.min(100,t)),Math.round(t/100*255).toString(16).padStart(2,"0").toUpperCase());c(e.rgb),d(e.hex+n)}})}),Object(s.jsx)("div",{className:"tool",children:Object(s.jsx)("button",{onClick:function(){return localStorage.setItem("savedDrawing",l.current.getSaveData()),j.addImage(localStorage.getItem("savedDrawing")),void l.current.clear()},children:"Tallenna kuva!"})})]})]})},C=function(e){var t=Object(r.useRef)(null);Object(r.useEffect)((function(){t.current.loadSaveData(e.data)}),[]);var a,n;return Object(s.jsx)("div",{className:"canvas",onClick:function(a){return t.current.clear(),void t.current.loadSaveData(e.data)},children:Object(s.jsx)(N.a,Object(v.a)(Object(v.a)({ref:t},e),{},{loadTimeOffset:(a=10,n=50,Math.floor(Math.random()*(n-a+1))+a)}))})},U=function(){var e=Object(r.useState)([]),t=Object(x.a)(e,2),a=t[0],n=t[1],c=Object(r.useState)(!0),i=Object(x.a)(c,2),u=i[0],o=i[1],d=Object(r.useState)([]),l=Object(x.a)(d,2),j=(l[0],l[1],Object(r.useContext)(m));Object(r.useEffect)((function(){var e=j.getImages().on("value",(function(e){for(var t=e.val(),a=[],s=0,r=Object.keys(t);s<r.length;s++){var c=r[s];a.push(t[c])}n(a),o(!1)}));return function(){return e}}),[j]);Object(r.useRef)(null);return Object(s.jsxs)("div",{className:"gallery",children:[u&&Object(s.jsx)("div",{className:"loading",children:Object(s.jsx)("p",{children:"Ootappa hetki, galleria latautuu..."})}),a?a.map((function(e,t){return Object(s.jsx)(C,{data:e,canvasHeight:200,canvasWidth:200,disabled:!0},t)})):Object(s.jsx)("h1",{className:"center",children:"Piirr\xe4p\xe4 kuva ni p\xe4\xe4st\xe4\xe4n alkuun!"})]})},E=function(){var e=Object(r.useContext)(m),t=Object(o.f)();return Object(r.useEffect)((function(){(null===e||void 0===e?void 0:e.getLoggedUser())||t.push(n.SIGN_IN)}),[]),Object(s.jsxs)("div",{className:"home",children:[Object(s.jsx)("h1",{className:"center",children:"Tervetuloa it-jonnen galleriaan!"}),Object(s.jsx)(U,{}),Object(s.jsx)("h1",{className:"center",children:"T\xe4h\xe4n voi sit vaikka piirt\xe4\xe4 jotain:"}),Object(s.jsx)(k,{lazyRadius:0,hideGrid:!0,brushRadius:5})]})},y=function(){return Object(s.jsxs)(u.a,{children:[Object(s.jsx)(g,{}),Object(s.jsx)(o.b,{exact:!0,path:n.HOME,component:E}),Object(s.jsx)(o.b,{path:n.SIGN_IN,component:I}),Object(s.jsx)(o.a,{from:"*",to:"/"})]})};i.a.render(Object(s.jsx)(m.Provider,{value:new f,children:Object(s.jsx)(y,{})}),document.getElementById("root"))}},[[228,1,2]]]);
//# sourceMappingURL=main.09c2d4e5.chunk.js.map